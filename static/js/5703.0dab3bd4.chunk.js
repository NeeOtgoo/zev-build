"use strict";(self.webpackChunkemind=self.webpackChunkemind||[]).push([[5703],{20077:function(n,e,t){t.d(e,{Di:function(){return y},Gn:function(){return E},IR:function(){return I},JO:function(){return b},LZ:function(){return v},Lp:function(){return P},Mo:function(){return T},OM:function(){return N},Q7:function(){return D},Qe:function(){return j},SX:function(){return C},vm:function(){return Z}});var r,i,s,a,o,c,l,d,u,m,$,h,g,p,S,f=t(30168),x=t(27570),y=(0,x.Ps)(r||(r=(0,f.Z)(["\n    mutation createSchool($name: String, $nameMgl: String) {\n      createSchool(name: $name, nameMgl: $nameMgl) {\n        school {\n          id\n          name\n          nameMgl\n        }\n      }\n    }\n"]))),j=(0,x.Ps)(i||(i=(0,f.Z)(["\n    mutation createSubSchool($name: String, $nameMgl: String, $school: Int!){\n      createSubSchool(name: $name, nameMgl: $nameMgl, school: $school) {\n        subSchool {\n          id\n          name\n          nameMgl \n          school {\n            id\n          }\n        }\n      }\n    }\n"]))),b=((0,x.Ps)(s||(s=(0,f.Z)(["\n    mutation register($email: String!, $username: String!, $isTeacher: Boolean!, $isStudent: Boolean!, $password1: String!, $password2: String!){\n      register(email: $email, username: $username, isTeacher: $isTeacher, isStudent: $isStudent, password1: $password1, password2: $password2) {\n          success\n          errors\n          token\n      } \n    }\n\n"]))),(0,x.Ps)(a||(a=(0,f.Z)(["\n    mutation createTeacher($address: String, $birthCity: Int, $birthDistrict: Int, $birthdate: String, $degree: Int,\n                            $familyName: String, $joinBefore: String, $joinDate: String, $name: String, $phone: String, $phone2: String,\n                            $registerNo: String, $school: Int, $sex: String, $status: Int, $subSchool: Int, $teacherCode: String!,\n                            $username: String!, $password: String!, $email: String!, $access: String!\n                            # $user: Int\n                            ) {\n      createTeacher(address: $address, birthCity: $birthCity, birthDistrict: $birthDistrict, birthdate: $birthdate, degree: $degree,\n                             familyName: $familyName, joinBefore: $joinBefore, joinDate: $joinDate, name: $name, phone: $phone, phone2: $phone2, \n                            registerNo: $registerNo, school: $school, sex: $sex, status: $status, subSchool: $subSchool, \n                            teacherCode: $teacherCode, access: $access,\n                            username: $username, password: $password, email: $email\n                            # user: $user \n                            ) {\n        teacher {\n          id\n        }\n      }\n    }\n"])))),v=(0,x.Ps)(o||(o=(0,f.Z)(["\n    mutation createEmployee(\n                $address: String\n                $birthCity: Int\n                $birthDistrict: Int\n                $birthdate: String\n                $email: String!\n                $employeeCode: String!\n                $familyName: String\n                $group: Int\n                $name: String\n                $password: String!\n                $phone: String\n                $phone2: String\n                $photo: Upload\n                $registerNo: String\n                $sex: String\n                $status: Int\n                $compartment: Int\n                $username: String!\n              ) {\n      createEmployee(\n                address: $address\n                birthCity: $birthCity\n                birthDistrict: $birthDistrict\n                birthdate: $birthdate\n                email: $email\n                employeeCode: $employeeCode\n                familyName: $familyName\n                group: $group\n                name: $name\n                password: $password\n                phone: $phone\n                phone2: $phone2\n                photo: $photo\n                compartment: $compartment\n                registerNo: $registerNo\n                sex: $sex\n                status: $status\n                username: $username\n          ) {\n          employee {\n          id\n        }\n      }\n    }\n"]))),Z=(0,x.Ps)(c||(c=(0,f.Z)(['\n    mutation createStudent(\n      $activity: Int\n      $address: String\n      $allergies: String\n      $birthCity: Int\n      $birthDistrict: Int\n      $birthdate: String\n      $bloodType: String\n      $bodyIndex: String\n      $classes: Int\n      $classtime: Int\n      $drug: String\n      $etc: String\n      $familyName: String\n      $joinDate: String\n      $joinSchoolyear: String\n      $name: String\n      $nationality: String\n      $phone: String\n      $program: Int\n      $registerNo: String\n      $religion: String\n      $school: Int\n      $section: Int\n      $sex: String\n      $state: String\n      $status: Int\n      $statusExtra: Int\n      $surname: String\n      $underlyingDisease: String\n      $vaccine: String\n    ) {\n      createStudent(\n        activity: $activity\n        address: $address\n        allergies: $allergies\n        birthCity: $birthCity\n        birthDistrict: $birthDistrict\n        birthdate: $birthdate\n        bloodType: $bloodType\n        bodyIndex: $bodyIndex\n        classes: $classes\n        classtime: $classtime\n        drug: $drug\n        email: "dummy@dummy.com"\n        etc: $etc\n        familyName: $familyName\n        joinDate: $joinDate\n        joinSchoolyear: $joinSchoolyear\n        name: $name\n        nationality: $nationality\n        phone: $phone\n        program: $program\n        registerNo: $registerNo\n        religion: $religion\n        school: $school\n        section: $section\n        sex: $sex\n        state: $state\n        status: $status\n        statusExtra: $statusExtra\n        surname: $surname\n        underlyingDisease: $underlyingDisease\n        vaccine: $vaccine\n      ) {\n        student {\n          id\n        }\n      }\n    }\n']))),D=(0,x.Ps)(l||(l=(0,f.Z)(["\n  mutation createSection($classes: Int, $maxStudentNum: Int, $program: Int, $teacher: Int,  $school: Int, $section: String, $subSchool: Int) {\n    createSection(classes: $classes, program: $program, school: $school, section: $section, subSchool: $subSchool, maxStudentNum: $maxStudentNum, teacher: $teacher) {\n      section {\n        section\n      }\n    }\n  }\n"]))),I=(0,x.Ps)(d||(d=(0,f.Z)(["\n  mutation createClasses($activity: Int, $classes: String,\n                          $program: Int, $school: Int, $status: String, $subSchool: Int) {\n    createClasses(activity: $activity, classes: $classes,\n                  program: $program, school: $school, status: $status, subSchool: $subSchool) {\n      classes {\n        classes\n      }\n    }\n  }\n"]))),N=(0,x.Ps)(u||(u=(0,f.Z)(["\n    mutation createProgram($program: String, $programMgl: String,  \n                           $status: String, $maxStudentNum: Int, $school: Int, $subSchool: Int) {\n      createProgram(program: $program, programMgl: $programMgl,  \n                    status: $status, maxStudentNum: $maxStudentNum, school: $school, subSchool: $subSchool) {\n        program {\n          id\n        }\n      }\n    }\n"]))),P=(0,x.Ps)(m||(m=(0,f.Z)(["\n  mutation createSubject($credit: String, $subject: String, $content: String, $school: Int, $subSchool: Int) {\n    createSubject(credit: $credit, subject: $subject, school: $school, content: $content, subSchool: $subSchool) {\n      subject {\n        credit\n      }\n    }\n  }\n"]))),T=((0,x.Ps)($||($=(0,f.Z)(["\n  mutation createProgramSubject($program: Int, $subject: Int) {\n    createProgramSubject(program: $program, subject: $subject) {\n      programSubjectType {\n        id\n      }\n    }\n  }\n"]))),(0,x.Ps)(h||(h=(0,f.Z)(["\n  mutation createRoutineStudent ($routine: Int, $studentCode: String, $section: Int) {\n    createRoutineStudent (routine: $routine, studentCode: $studentCode, section: $section) {\n      routineStudent {\n        id\n      }\n    }\n  }\n"]))),(0,x.Ps)(g||(g=(0,f.Z)(["\n    mutation createParent ($address: String, $familyName: String, $name: String, $phone: String, $profession: String, $student: Int) {\n        createParent (address: $address, familyName: $familyName, name: $name, phone: $phone, profession: $profession, student: $student) {\n            parent {\n                name\n            }\n        }\n    }\n"])))),C=(0,x.Ps)(p||(p=(0,f.Z)(["\n    mutation createEventType ($color: String, $name: String) {\n        createEventType (color: $color, name: $name) {\n            eventType {\n                name\n            }\n        }\n    }\n"]))),E=(0,x.Ps)(S||(S=(0,f.Z)(["\n    mutation createEvent ($content: String, $description: String, $endAt: String, $eventType: Int, $startAt: String, $title: String) {\n        createEvent (content: $content, description: $description, endAt: $endAt, eventType: $eventType, startAt: $startAt, title: $title) {\n            event {\n                title\n            }\n        }\n    }\n"])))},64856:function(n,e,t){t.d(e,{DO:function(){return b},Fo:function(){return I},Jk:function(){return E},MI:function(){return P},NH:function(){return y},Tu:function(){return j},Ug:function(){return C},Xj:function(){return D},dc:function(){return N},mL:function(){return v},tc:function(){return Z},xB:function(){return T}});var r,i,s,a,o,c,l,d,u,m,$,h,g,p,S,f=t(30168),x=t(27570),y=((0,x.Ps)(r||(r=(0,f.Z)(["\n    mutation deleteCity($id: ID!){\n        deleteCity(id: $id){\n            city{\n              name\n              code\n            }\n        }\n    }\n"]))),(0,x.Ps)(i||(i=(0,f.Z)(["\n    mutation deleteAccount($username: String) {\n        deleteAccount(username: $username) {\n            account {\n                username\n            }\n        }\n    }\n"]))),(0,x.Ps)(s||(s=(0,f.Z)(["\n    mutation deleteTeacher($id: ID!){\n      deleteTeacher(id: $id){\n            teacher{\n              name\n            }\n        }\n    }\n"])))),j=(0,x.Ps)(a||(a=(0,f.Z)(["\n  mutation deleteEmployee($id: ID){\n    deleteEmployee(id: $id){\n      employee{\n        name\n      }\n    }\n  }\n  "]))),b=(0,x.Ps)(o||(o=(0,f.Z)(["\n  mutation deleteSubject ($id: ID) {\n    deleteSubject (id: $id) {\n      subject {\n        credit\n      }\n    }\n  }\n"]))),v=(0,x.Ps)(c||(c=(0,f.Z)(["\n    mutation deleteStudent($id: ID!){\n      deleteStudent(id: $id){\n            student{\n              surname\n            }\n        }\n    }\n"]))),Z=(0,x.Ps)(l||(l=(0,f.Z)(["\n  mutation deleteSubSchool($id: ID){\n    deleteSubSchool(id: $id){\n      subSchool{\n        name\n      }\n    }\n}\n"]))),D=(0,x.Ps)(d||(d=(0,f.Z)(["\n  mutation deleteSchool($id: ID!){\n    deleteSchool(id: $id){\n      school{\n        name\n      }\n    }\n}\n"]))),I=(0,x.Ps)(u||(u=(0,f.Z)(["\n  mutation deleteSection($id: ID){\n    deleteSection(id: $id){\n      section{\n        section\n      }\n    }\n}\n"]))),N=(0,x.Ps)(m||(m=(0,f.Z)(["\n  mutation deleteClasses($id: ID!){\n    deleteClasses(id: $id){\n      classes{\n        classes\n      }\n    }\n}\n"]))),P=(0,x.Ps)($||($=(0,f.Z)(["\n    mutation deleteProgram($id: ID!){\n        deleteProgram(id: $id){\n            program{\n                program\n            }\n        }\n    }\n"]))),T=((0,x.Ps)(h||(h=(0,f.Z)(["\n    mutation deleteRoutine ($id: ID) {\n        deleteRoutine (id: $id) {\n            routine {\n                createdAt\n            }\n        }\n    }\n"]))),(0,x.Ps)(g||(g=(0,f.Z)(["\n    mutation deleteParent ($id: ID) {\n        deleteParent (id: $id) {\n            parent {\n                name\n            }\n        }\n    }\n"])))),C=(0,x.Ps)(p||(p=(0,f.Z)(["\n    mutation deleteEventType ($id: ID) {\n        deleteEventType (id: $id) {\n            eventType {\n                name\n            }\n        }\n    }\n"]))),E=(0,x.Ps)(S||(S=(0,f.Z)(["\n    mutation deleteEvent ($id: ID) {\n        deleteEvent (id: $id) {\n            event {\n                title\n            }\n        }\n    }\n"])))},65703:function(n,e,t){t.r(e),t.d(e,{default:function(){return L}});var r=t(72791),i=t(29439),s=t(20003),a=t(50419),o=t(75594),c=t(66871),l=t(87309),d=t(66106),u=t(30914),m=t(89620),$=t(72426),h=t.n($),g=t(31549),p=t(41920),S=t(82630),f=t(96578),x=t(84376),y=t(38937),j=t(22949),b=t(49389),v=t(70163),Z=t(73332),D=t(20077),I=t(82259),N=t(80184),P=j.Z.Option,T=b.Z.TextArea,C=v.Z.RangePicker,E=function(n){var e=n.visible,t=n.cancel,c=n.refetch,d=n.allEventTypes,u=n.formType,m=n.event,$=Z.Z.useForm(),g=(0,i.Z)($,1)[0],p=(0,x.D)(D.Gn,{onCompleted:function(n){a.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),g.resetFields(),c(),t()}}),f=(0,i.Z)(p,2),y=f[0],v=f[1].loading,E=(0,x.D)(I.aY,{onCompleted:function(n){a.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0445\u0430\u0434\u0433\u0430\u043b\u043b\u0430\u0430"),g.resetFields(),c(),t()}}),w=(0,i.Z)(E,2),M=w[0],A=w[1].loading;(0,r.useEffect)((function(){"edit"===u&&function(){var n,e={title:m.title,description:m.description,content:m.content,eventType:null===(n=m.eventType)||void 0===n?void 0:n.id,dates:[h().utc(m.startAt),h().utc(m.endAt)]};g.setFieldsValue(e)}()}),[m,g,u]);return(0,N.jsx)(s.Z,{title:"edit"===u?m.title:(0,N.jsx)(S.Z,{id:"add_new"}),visible:e,footer:null,destroyOnClose:!0,onCancel:t,children:(0,N.jsxs)(Z.Z,{layout:"vertical",name:"event-form",id:"event-form",form:g,preserve:!1,onFinish:function(n){n.dates.map((function(e,t){return 0===t?n.startAt=h()(e).format("YYYY-MM-DD HH:mm"):n.endAt=h()(e).format("YYYY-MM-DD HH:mm")})),n.hasOwnProperty("endAt")&&("edit"===u?(n.id=m.id,M({variables:n})):y({variables:n}))},children:[(0,N.jsx)(Z.Z.Item,{name:"title",label:(0,N.jsx)(S.Z,{id:"title"}),rules:[{required:!0,message:(0,N.jsx)(S.Z,{id:"form.required"})}],children:(0,N.jsx)(b.Z,{})}),(0,N.jsx)(Z.Z.Item,{name:"eventType",label:(0,N.jsx)(S.Z,{id:"event-type"}),rules:[{required:!0,message:(0,N.jsx)(S.Z,{id:"form.required"})}],children:(0,N.jsx)(j.Z,{children:null===d||void 0===d?void 0:d.map((function(n,e){return(0,N.jsxs)(P,{value:n.id,children:[(0,N.jsx)(o.Z,{color:n.color}),(0,N.jsx)("span",{className:"text-capitalize font-weight-semibold",children:n.name})]},e)}))})}),(0,N.jsx)(Z.Z.Item,{name:"description",label:(0,N.jsx)(S.Z,{id:"description"}),rules:[{required:!0,message:(0,N.jsx)(S.Z,{id:"form.required"})}],children:(0,N.jsx)(T,{rows:4})}),(0,N.jsx)(Z.Z.Item,{name:"content",label:(0,N.jsx)(S.Z,{id:"content"}),rules:[{required:!0,message:(0,N.jsx)(S.Z,{id:"form.required"})}],children:(0,N.jsx)(T,{rows:4})}),(0,N.jsx)(Z.Z.Item,{name:"dates",label:(0,N.jsx)(S.Z,{id:"start_end_date"}),rules:[{required:!0,message:(0,N.jsx)(S.Z,{id:"form.required"})}],children:(0,N.jsx)(C,{className:"w-100",showTime:!0})}),(0,N.jsx)(Z.Z.Item,{className:"text-right mb-0",children:(0,N.jsx)(l.Z,{type:"primary",htmlType:"submit",loading:v||A,children:(0,N.jsx)(S.Z,{id:"main.okText"})})})]})})},w=t(9168),M=t(36795),A=t(82464),k=t(74508),Y=function(n){var e,t=n.data,r=n.canDelete,i=n.onDelete,s=n.onSingleEventSelect,a=n.canEdit;return(0,N.jsx)("div",{className:"transition rounded-1 min-h-56 my-4 bg-background hover:cursor-pointer hover:-translate-y-1 hover:scale-102  duration-300",children:(0,N.jsxs)("div",{className:"mx-6 my-4 p-2",children:[(0,N.jsxs)("div",{className:"font-medium py-2 text-base border-b border-gray-light text-gray-700",children:[(0,N.jsx)(o.Z,{color:t.eventType.color}),t.title]}),(0,N.jsxs)("div",{className:"flex flex-col space-y-1 mt-2",children:[(0,N.jsxs)("span",{className:"flex items-center",children:[(0,N.jsx)(k.Z,{className:"h-4 text-emind mr-2"}),h().utc(t.startAt).format("HH:mm")," - ",h().utc(t.endAt).format("HH:mm")]}),(0,N.jsx)("p",{className:"font-normal text-gray-700 text-sm mb-2",children:t.description}),(0,N.jsx)("p",{className:"font-normal text-gray-700 text-sm mb-4",children:t.content})]}),r||a?(e=t,(0,N.jsxs)("div",{className:"flex justify-between p-2 border-t border-gray-light",children:[!0===a&&(0,N.jsx)(l.Z,{onClick:function(){return s(t)},type:"text",shape:"circle",icon:(0,N.jsx)(M.Z,{twoToneColor:"#ffdb00"})}),!0===r&&(0,N.jsx)(l.Z,{onClick:function(){return i(e.id)},type:"text",shape:"circle",icon:(0,N.jsx)(A.Z,{twoToneColor:"#f42f2f"})})]})):null]})})},O=t(79335),q=function(n){var e=n.list,t=n.onDelete,s=n.canDelete,a=n.canEdit,o=n.allEventTypes,c=n.refetch,l=(0,r.useState)(!1),d=(0,i.Z)(l,2),u=d[0],m=d[1],$=(0,r.useState)({}),h=(0,i.Z)($,2),g=h[0],p=h[1],S=e.reduce((function(n,e){var t=e.startAt.split("T")[0];return n[t]||(n[t]=[]),n[t].push(e),n}),{}),f=Object.keys(S).map((function(n){return{date:n,events:S[n]}}));f.sort((function(n,e){return new Date(n.date)-new Date(e.date)}));var x=function(n){m(!0),p(n)};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(O.ZP,{className:"h-5/6",children:f.map((function(n,e){return(0,N.jsxs)("div",{className:"p-4",children:[(0,N.jsxs)("h4",{children:[(0,N.jsx)(w.Z,{}),(0,N.jsx)("span",{className:"ml-2",children:n.date})]}),n.events.map((function(n,e){return(0,N.jsx)(Y,{data:n,canDelete:s,canEdit:a,onDelete:t,onSingleEventSelect:x},e)}))]},e)}))}),(0,N.jsx)(E,{formType:"edit",refetch:c,cancel:function(){m(!1)},visible:u,allEventTypes:o,event:g,canEdit:a})]})},H=function(n){var e=n.visible,t=n.cancel,r=n.selectedDate,i=n.datas,a=n.canDelete,o=n.onDelete;return(0,N.jsx)(s.Z,{title:r,visible:e,footer:null,destroyOnClose:!0,onCancel:t,children:i.map((function(n,e){return(0,N.jsx)(Y,{data:n,canDelete:a,onDelete:o},e)}))})},B=t(64856),F="MMMM DD",R=s.Z.confirm,_=function(n){var e=n.permissions,t=(0,r.useState)([]),s=(0,i.Z)(t,2),$=s[0],j=s[1],b=(0,r.useState)(!1),v=(0,i.Z)(b,2),Z=v[0],D=v[1],I=(0,r.useState)(!1),P=(0,i.Z)(I,2),T=P[0],C=P[1],w=(0,r.useState)(),M=(0,i.Z)(w,2),A=M[0],k=M[1],Y=(0,r.useState)([]),O=(0,i.Z)(Y,2),_=O[0],J=O[1],L=(0,f.a)(p.Be).data,G=(0,f.a)(p.Ko,{onCompleted:function(n){j(n.allEvents)}}),Q=G.loading,U=G.refetch,X=(0,x.D)(B.Jk,{onCompleted:function(n){C(!1),D(!1),a.ZP.success("\u0410\u043c\u0436\u0438\u043b\u0442\u0442\u0430\u0439 \u0443\u0441\u0442\u043b\u0430\u0430!"),U()}}),z=(0,i.Z)(X,1)[0],K=function(n){var e=[];return $.forEach((function(t){h()(t.startAt).format(F)===n&&e.push(t)})),e.sort((function(n,e){return new Date(n.startAt)-new Date(e.startAt)})),e},V=function(n){R({title:"\u0423\u0441\u0442\u0433\u0430\u0445 \u0443\u0443?",okText:"\u0423\u0441\u0442\u0433\u0430\u0445",okType:"danger",cancelText:"\u0411\u043e\u043b\u0438\u0445",onOk:function(){z({variables:{id:n}})}})},W=function(){D(!1),C(!1)};return Q?(0,N.jsx)(y.Z,{cover:"content"}):(0,N.jsxs)(c.Z,{className:"calendar",children:[(0,N.jsxs)("div",{className:"justify-between md:flex",children:[(0,N.jsx)("div",{className:"hidden md:block",children:null===L||void 0===L?void 0:L.allEventTypes.map((function(n,e){return(0,N.jsx)(o.Z,{className:"mr-4",color:n.color,text:n.name},e)}))}),(0,N.jsx)("div",{className:"",children:!0===e.create&&(0,N.jsxs)(l.Z,{onClick:function(){return D(!0)},type:"primary",icon:(0,N.jsx)(g.Z,{}),block:!0,children:[" ",(0,N.jsx)(S.Z,{id:"add_new"})," "]})})]}),(0,N.jsxs)(d.Z,{gutter:[16,16],children:[(0,N.jsxs)(u.Z,{xs:24,sm:24,md:9,lg:6,children:[(0,N.jsx)("h2",{className:"mb-4",children:(0,N.jsx)(S.Z,{id:"event"})}),(0,N.jsx)(q,{canDelete:e.destroy,canEdit:e.edit,list:$,onDelete:V,allEventTypes:null===L||void 0===L?void 0:L.allEventTypes,refetch:U})]}),(0,N.jsx)(u.Z,{xs:24,sm:24,md:15,lg:18,children:(0,N.jsx)(m.Z,{onSelect:function(n){return function(n){var e=h()(n).format(F),t=[];$.filter((function(e){return h()(e.startAt).format("YYYY-MM-DD")===n.format("YYYY-MM-DD")})).map((function(n){return t.push(n)})),t.sort((function(n,e){return new Date(n.startAt)-new Date(e.startAt)})),J(t),k(e),C(!0)}(n)},dateCellRender:function(n){var e=K(n.format(F));return(0,N.jsx)("ul",{className:"calendar-event",children:e.map((function(n,e){return(0,N.jsx)("li",{children:(0,N.jsx)(o.Z,{color:n.eventType.color,text:n.title})},"".concat(n.title,"-").concat(e))}))})}})})]}),(0,N.jsx)(H,{canDelete:e.destroy,onDelete:V,selectedDate:A,visible:T,cancel:W,datas:_}),(0,N.jsx)(E,{refetch:U,visible:Z,cancel:W,allEventTypes:null===L||void 0===L?void 0:L.allEventTypes})]})},J=t(59288),L=function(n){var e={create:(0,J.C)("add_event"),edit:(0,J.C)("change_event"),destroy:(0,J.C)("delete_event")};return Object.values(e).indexOf("loading")>-1?(0,N.jsx)(y.Z,{cover:"content"}):(0,N.jsx)(_,{permissions:e})}}}]);
//# sourceMappingURL=5703.0dab3bd4.chunk.js.map